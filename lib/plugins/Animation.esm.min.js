/*
* Animation v1.0.0
* https://sunshine-themes.com/intersectionTrigger
*
* @license Copyright 2022, Sunshine. All rights reserved.
* Subject to the terms at https://sunshine-themes.com/intersectionTrigger/standard-licensew.
* @author: Sherif magdy, sherifmagdy@sunshine-themes.com
*/
                  
var j=()=>{};var F=["play","complete","reverse","complete"],A={to:null,after:1,speed:100,maxDistance:500,onStart:j,onComplete:j};var y={instance:null,toggleActions:F,link:!1,snap:!1};var r={function:t=>typeof t=="function",string:t=>typeof t=="string",boolean:t=>typeof t=="boolean",object:t=>t&&typeof t=="object"&&!(t instanceof Array),inObject:(t,e)=>r.object(t)&&e in t,num:t=>typeof t=="number",percent:t=>t&&t.includes("%"),pixel:t=>t&&t.includes("px"),array:t=>t instanceof Array,element:t=>t instanceof HTMLElement||t instanceof Element,doc:t=>t&&t.nodeType===9,scrollable:(t,e=null)=>e?e==="y"?t.scrollHeight>t.clientHeight:t.scrollWidth>t.clientWidth:t.scrollHeight>t.clientHeight||t.scrollWidth>t.clientWidth,anime:t=>r.object(t)&&t.hasOwnProperty("animatables")&&!t.hasOwnProperty("add"),tl:t=>r.object(t)&&t.hasOwnProperty("add")&&r.function(t.add),animeInstance:t=>r.anime(t)||r.tl(t)},C=(t,e,a)=>Math.min(Math.max(t,e),a),L=t=>t.split(/\s+/);var _=(t,e)=>{let a=t,o=e;return Object.entries(a).forEach(([s,u])=>{r.object(u)?_(u,o[s]=o[s]||{}):s in o||(o[s]=u)}),o},D=t=>{throw new Error(t)};var N=class{constructor(e){return this._registerIntersectionTrigger(e),this.init(),this}init(){this._snap={};let{ref:e,refOpposite:a,length:o}=this._utils.dirProps(),s=this._utils.isVirtical(),u=this._utils.getRoot();this.seek=(i,n,c)=>{if(r.num(c)){setTimeout(()=>i.seek(n),c*1e3);return}i.seek(n)},this.startSnaping=({snapDistance:i,currentDis:n,snap:c,step:l,toRef:p=!1})=>{let d=p?-1:1;if(s?u.scrollBy({top:l*d,behavior:"instant"}):u.scrollBy({left:l*d,behavior:"instant"}),n+=l,n>=i){n=0,c.onComplete(this._it);return}requestAnimationFrame(()=>this.startSnaping({snapDistance:i,currentDis:n,snap:c,step:l,toRef:p}))},this.animateHandler=(i,{enter:n,leave:c,tIL:l,instance:p,duration:d,snap:h,step:S,link:P})=>{let f=i.getBoundingClientRect(),m=this._utils.getTriggerStates(i,"ids");this._it.rootBounds=this._utils.getRootRect(this._it.observer.rootMargin);let b=this._it.rootBounds,k=l+(this._it._isREPGreater?b[o]:-b[o]),g=0,[T,V,I,q]=this._utils.getPositions(f,b,{enter:n,leave:c,ref:e,refOpposite:a,length:o}),v=I-T;if(v>0&&(g=d*v/k,this.seek(p,g,P)),h){let H=0;clearTimeout(m.snapTimeOutId);let R=setTimeout(()=>{let x=h.to.map(E=>g-E),B=x.map(E=>Math.abs(E)),M=Math.min(...B),W=x[B.indexOf(M)],O=k*M/d,w={snapDistance:O,currentDis:H,snap:h,step:S};if(!(O>=h.maxDistance||O<S)){if(h.onStart(this._it),W<0){this.startSnaping(w);return}this.startSnaping({...w,toRef:!0})}},h.after*1e3);this._utils.setTriggerStates(i,{ids:{...m,snapTimeOutId:R}})}}}_registerIntersectionTrigger(e){this._it=e,this._utils=this._it._utils}animate(e,a,o){let{instance:s,toggleActions:u,link:i,snap:n}=a;if(!s)return;if(i){let{animate:l}=this._utils.getTriggerStates(e,"onScroll"),p=this._utils.getTriggerStates(e,"ids"),{enter:d,leave:h,minPosition:S,maxPosition:P}=this._utils.getTriggerData(e),{length:f}=this._utils.dirProps(),m=e.getBoundingClientRect(),b=m[f]-(S*m[f]+(1-P)*m[f]),k=s.duration,g=0;n&&(g=Math.round(Math.max(n.speed*17/1e3,1)));let T={enter:d,leave:h,tIL:b,instance:s,duration:k,snap:n,link:i,step:g};switch(o){case 0:case 2:if(this._it._states.oCbFirstInvoke&&this.animateHandler(e,T),l)break;this._utils.setTriggerScrollStates(e,"animate",()=>this.animateHandler(e,T));break;case 1:case 3:clearTimeout(p.snapTimeOutId),this._utils.setTriggerScrollStates(e,"animate",null),this.seek(s,o===1?k:0,i);break}return}let c=u[o];if(c!=="none")switch(c){case"play":s.reversed&&s.reverse(),1>s.progress&&s[c]();break;case"restart":case"reset":s.reversed&&s.reverse(),s[c]();break;case"pause":s[c]();break;case"complete":s.pause(),s.seek(s.reversed?0:s.duration);break;case"reverse":if(s.reversed)break;s[c](),s.paused&&s.play();break;case"kill":r.inObject(s,"kill")&&s.kill(),this._utils.setTriggerData(e,null,{animation:{...y}});break}}parse(e){let a={};switch(!0){case r.animeInstance(e):a=_(y,{instance:e});break;case r.object(e):{this._params=_(y,e),r.animeInstance(this._params.instance)||D("Invalid anime instance");let{toggleActions:o,snap:s}=this._params;s&&(this._params.snap=this.parseSnap()),r.string(o)&&(this._params.toggleActions=L(o)),a=this._params}break}return r.inObject(a,"instance")&&a.instance.reset(),a}parseSnap(){let{instance:e,snap:a}=this._params,o=n=>{let c=[],l=n;for(;l<1;)c.push(C(l,0,1)),l=l+n;return c.map(p=>Math.round(p*e.duration))},s=n=>{if(r.num(n))return o(n);if(r.string(n))return u(n);if(r.array(n))return n},u=()=>r.inObject(e,"marks")?e.marks.map(l=>l.time):void 0,i={};switch(!0){case(r.boolean(a)&&a):i.to=u(a);break;case r.array(a):i.to=a;break;case r.num(a):i.to=o(a);break;case r.object(a):i=a,i.to=s(i.to);break}return _(A,i)}update(){}kill(){this._it=null,this._utils=null}};export{N as default};
