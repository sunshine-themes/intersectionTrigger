/*
* Animation v1.0.0
* https://sunshine-themes.com/intersectionTrigger
*
* @license Copyright 2022, Sunshine. All rights reserved.
* Subject to the terms at https://sunshine-themes.com/intersectionTrigger/standard-licensew.
* @author: Sherif magdy, sherifmagdy@sunshine-themes.com
*/
                  
var D=Object.defineProperty;var q=t=>D(t,"__esModule",{value:!0});var U=(t,e)=>{for(var m in e)D(t,m,{get:e[m],enumerable:!0})};q(exports);U(exports,{default:()=>F});var L=()=>{};var $=["play","complete","reverse","complete"],B={to:null,after:1,speed:100,maxDistance:500,onStart:L,onComplete:L};var T={instance:null,toggleActions:$,link:!1,snap:!1};var l={function:t=>typeof t=="function",string:t=>typeof t=="string",boolean:t=>typeof t=="boolean",object:t=>t&&typeof t=="object"&&!(t instanceof Array),inObject:(t,e)=>l.object(t)&&e in t,num:t=>typeof t=="number",percent:t=>t&&t.includes("%"),pixel:t=>t&&t.includes("px"),array:t=>t instanceof Array,element:t=>t instanceof HTMLElement||t instanceof Element,doc:t=>t&&t.nodeType===9,scrollable:(t,e=null)=>e?e==="y"?t.scrollHeight>t.clientHeight:t.scrollWidth>t.clientWidth:t.scrollHeight>t.clientHeight||t.scrollWidth>t.clientWidth,anime:t=>l.object(t)&&t.hasOwnProperty("animatables")&&!t.hasOwnProperty("add"),tl:t=>l.object(t)&&t.hasOwnProperty("add")&&l.function(t.add),animeInstance:t=>l.anime(t)||l.tl(t)},w=(t,e,m)=>Math.min(Math.max(t,e),m),C=t=>t.split(/\s+/);var _=(t,e)=>{let m=t,o=e;return Object.entries(m).forEach(([i,f])=>{l.object(f)?_(f,o[i]=o[i]||{}):i in o||(o[i]=f)}),o},j=t=>{throw new Error(t)};var F=class{constructor(e){return this._registerIntersectionTrigger(e),this.setUtils(),this}_registerIntersectionTrigger(e){this._it=e,this._utils=this._it._utils}setUtils(){let{ref:e,refOpposite:m,length:o}=this._utils.dirProps(),i=this._utils.isVirtical(),f=this._utils.getRoot(),d=new WeakMap;this.seekSmoothly=(n,s,r,a)=>{if(this._it.killed)return this.kill();let g=n.currentTime,c=a?Math.min(g+r,s):Math.max(g-r,s);if(n.seek(c),a?c>=s:c<=s)return;let u=requestAnimationFrame(()=>this.seekSmoothly(n,s,r,a));d.set(n,u)},this.seek=(n,s,r)=>{if(l.num(r)){let a=n.currentTime,g=s>a,c=d.has(n)&&d.get(n)||0;cancelAnimationFrame(c),this.seekSmoothly(n,s,r,g);return}n.seek(s)},this.startSnaping=({snapDistance:n,currentDis:s,snap:r,step:a,toRef:g=!1})=>{if(this._it.killed)return this.kill();let c=g?-1:1;if(i?f.scrollBy({top:a*c,behavior:"instant"}):f.scrollBy({left:a*c,behavior:"instant"}),s+=a,s>=n){s=0,r.onComplete(this._it);return}requestAnimationFrame(()=>this.startSnaping({snapDistance:n,currentDis:s,snap:r,step:a,toRef:g}))},this.parseSnap=({instance:n,snap:s},r=!1)=>{let a=h=>{let k=[],p=h;for(;p<1;)k.push(w(p,0,1)),p=p+h;return k.map(S=>Math.round(S*n.duration))},g=h=>{if(l.num(h))return a(h);if(l.string(h))return c(h);if(l.array(h))return h},c=()=>{if(!!l.inObject(n,"marks"))return n.marks.map(h=>h.time)},b=(h,k)=>r?h.toOriginal:k,u={};switch(!0){case(l.boolean(s)&&s):!r&&(u.toOriginal="marks"),u.to=c(b(u,s));break;case l.array(s):!r&&(u.toOriginal=s),u.to=b(u,s);break;case l.num(s):!r&&(u.toOriginal=s),u.to=a(b(u,s));break;case l.object(s):u=s,!r&&(u.toOriginal=u.to),u.to=g(b(u,u.to));break}return _(B,u)},this.getTIL=(n,s,r)=>{let a=n.getBoundingClientRect();return a[o]-(s*a[o]+(1-r)*a[o])},this.getSnapStep=n=>n&&Math.round(Math.max(n.speed*17/1e3,1)),this.animateHandler=(n,{enter:s,leave:r,tIL:a,instance:g,snap:c,step:b,link:u})=>{if(this._it.killed)return this.kill();let h=n.getBoundingClientRect(),k=this._utils.getTriggerStates(n,"ids");this._it.rootBounds=this._utils.getRootRect(this._it.observer.rootMargin);let p=this._it.rootBounds,S=a+(this._it._isREPGreater?p[o]:-p[o]),x=g.duration,y=0,[H,z,R,G]=this._utils.getPositions(h,p,{enter:s,leave:r,ref:e,refOpposite:m,length:o}),E=R-H;if(E>0&&(y=x*E/S,this.seek(g,y,u)),c){let W=0;clearTimeout(k.snapTimeOutId);let N=setTimeout(()=>{let v=c.to.map(P=>y-P),I=v.map(P=>Math.abs(P)),M=Math.min(...I),V=v[I.indexOf(M)],O=S*M/x,A={snapDistance:O,currentDis:W,snap:c,step:b};if(!(O>=c.maxDistance||O<b)){if(c.onStart(this._it),V<0){this.startSnaping(A);return}this.startSnaping({...A,toRef:!0})}},c.after*1e3);this._utils.setTriggerStates(n,{ids:{...k,snapTimeOutId:N}})}}}animate(e,m,o){let{instance:i,toggleActions:f,link:d,snap:n}=m;if(!i)return;if(d){let{animate:r}=this._utils.getTriggerStates(e,"onScroll"),a=this._utils.getTriggerStates(e,"ids"),{enter:g,leave:c,minPosition:b,maxPosition:u}=this._utils.getTriggerData(e),h=this.getTIL(e,b,u),k=this.getSnapStep(n)||0,p={enter:g,leave:c,tIL:h,instance:i,snap:n,link:Math.abs(d),step:k};switch(o){case 0:case 2:if(this._it._states.oCbFirstInvoke&&this.animateHandler(e,p),r)break;this._utils.setTriggerScrollStates(e,"animate",()=>this.animateHandler(e,p));break;case 1:case 3:clearTimeout(a.snapTimeOutId),this._utils.setTriggerScrollStates(e,"animate",null),this.seek(i,o===1?i.duration:0,d);break}return}let s=f[o];if(s!=="none")switch(s){case"play":i.reversed&&i.reverse(),1>i.progress&&i[s]();break;case"restart":case"reset":i.reversed&&i.reverse(),i[s]();break;case"pause":i[s]();break;case"complete":i.pause(),i.seek(i.reversed?0:i.duration);break;case"reverse":if(i.reversed)break;i[s](),i.paused&&i.play();break;case"kill":l.inObject(i,"kill")&&i.kill(),this._utils.setTriggerData(e,null,{animation:{...T}});break}}parse(e,m=!1){let o={};switch(!0){case l.animeInstance(e):o=_(T,{instance:e});break;case l.object(e):{o=_(T,e);let{toggleActions:i,snap:f,instance:d}=o;f&&(o.snap=this.parseSnap({instance:d,snap:f},m)),l.string(i)&&(o.toggleActions=C(i))}break}return!l.animeInstance(o.instance)&&j("Invalid anime instance"),l.inObject(o,"instance")&&o.instance.reset(),o}update(){this._it.triggers.forEach(e=>{let{enter:m,leave:o,minPosition:i,maxPosition:f,animation:d}=this._utils.getTriggerData(e);d=this.parse(d,!0),this._utils.setTriggerData(e,null,{animation:d});let{animate:n}=this._utils.getTriggerStates(e,"onScroll");if(n){let{instance:s,snap:r,link:a}=d,g=this.getTIL(e,i,f),c=this.getSnapStep(r)||0;this._utils.setTriggerScrollStates(e,"animate",null),this._utils.setTriggerScrollStates(e,"animate",()=>this.animateHandler(e,{enter:m,leave:o,instance:s,snap:r,link:a,tIL:g,step:c}))}})}kill(){this._it=null,this._utils=null}};
